+++
title = "ADV: ADV is a Dependency Viewer"
date = 2009-02-10T13:25:00Z
updated = 2016-02-07T14:11:32Z
tags = ["cool hacks"]
blogimport = true 
[author]
	name = "Damien Lespiau"
	uri = "https://plus.google.com/114288295280403017038"
+++

<div dir="ltr" style="text-align: left;" trbidi="on">A few months ago I wrote a small script to draw a dependency graph between the object files of a library (the original idea is from Lionel Landwerlin). You'll need an archive of your library for the tool to be able to look for the needed pieces. Let's have a look at a sample of its output to understand what it does. I ran it against the HEAD of <a href="http://www.clutter-project.org/" title="clutter">clutter</a>.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-7IuVVtFyFZk/VrdQOFiOs0I/AAAAAAAAAbQ/aJhyh7AafpY/s1600/clutter-b4f9c8204d.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="372" src="https://4.bp.blogspot.com/-7IuVVtFyFZk/VrdQOFiOs0I/AAAAAAAAAbQ/aJhyh7AafpY/s640/clutter-b4f9c8204d.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><span style="font-size: small; text-align: left;">A view of the clutter library</span></td></tr></tbody></table><br /><br />This graph was generated with the following (tred is part of graphviz to do transitive reductions on graphs):<br /><br /><code>$ adv.py clutter/.libs/libclutter-glx-0.9.a | tred | dot -Tsvg &gt; clutter.svg</code><br /><br />You can provide more than one library to the tool:<br /><br /><code>./adv.py ../clutter/clutter/.libs/libclutter-glx-0.9.a \<br />../glib-2.18.4/glib/.libs/libglib-2.0.a \<br />../glib-2.18.4/gobject/.libs/libgobject-2.0.a \<br />| tred | dot -Tsvg &gt; clutter-glib-gobject-boxed.svg</code><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-9whFAbspGDg/VrdQgFXnuLI/AAAAAAAAAbU/GFL4_e_5gbI/s1600/clutter-glib-gobject-small.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="397" src="https://1.bp.blogspot.com/-9whFAbspGDg/VrdQgFXnuLI/AAAAAAAAAbU/GFL4_e_5gbI/s640/clutter-glib-gobject-small.png" width="640" /></a></div><br /><br />What you can do with this:<br /><ul><li>trim down your library by removing the object files you don't need and that are leafs in the graph. This was actually the reason behind the script and it proved useful,</li><li>get an overview of a library,</li><li>make part of a library optional more easily.</li></ul><br />To make the script work you'll need graphviz, python, ar and nm (you can provide a cross compiler prefix with --cross-prefix).<br /><br />Interested? clone it! (or <a href="http://git.lespiau.name/cgit/adv/tree/adv.py" title="adv git repository">look at the code</a>)<br /><br /><code>$ git clone git://git.lespiau.name/misc/adv</code></div>
